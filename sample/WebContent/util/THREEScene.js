sap.ui.define(['sap/ui/core/Control','sap/ui/core/HTML'],function(Control,HTML){'use strict';return Control.extend("influenz.de.sample.util.THREEScene",{metadata:{properties:{height:{defaultValue:1280,type:"int"},width:{defaultValue:720,type:"int"},antiAlias:{defaultValue:true,type:"boolean"},alpha:{defaultValue:true,type:"boolean"}},events:{nextFrame:{enablePreventDefault:true}},aggregations:{objects:{type:"influenz.de.sample.util.THREEObject",multiple:true,singularName:"object"},camera:{types:["influenz.de.sample.util.THREEPerspectiveCamera","influenz.de.sample.util.THREECubeCamera"],multiple:false},directionalLight:{type:"influenz.de.sample.util.THREEDirectionalLight",multiple:false},ambientLight:{type:"influenz.de.sample.util.THREEAmbientLight",multiple:false}}},init:function init(){},onBeforeRendering:function onBeforeRendering(){this.scene=new THREE.Scene();this.webGLRenderer=new THREE.WebGLRenderer({antialias:this.getAntiAlias(),alpha:this.getAlpha()});this.webGLRenderer.setSize(this.getWidth(),this.getHeight());},getScene:function getScene(){return this.scene;},getWebGLRenderer:function getWebGLRenderer(){return this.webGLRenderer;},_renderPerFrame:function _renderPerFrame(){var scene=this.getScene();var camera=this.getAggregation("camera").getCamera();var webGLRenderer=this.getWebGLRenderer();scene.add(this.getAggregation("directionalLight").getDirectionalLight());scene.add(this.getAggregation("ambientLight").getAmbientLight());this.fireNextFrame();camera.lookAt(scene.position);requestAnimationFrame(this._renderPerFrame.bind(this));webGLRenderer.render(scene,camera);},renderer:{render:function render(rendererManager,control){var objLoader=new THREE.OBJLoader(new THREE.LoadingManager());rendererManager.write("<div");rendererManager.writeControlData(control);rendererManager.write(">");rendererManager.write("<ul");rendererManager.write(">");rendererManager.renderControl(control.getAggregation("camera"));rendererManager.renderControl(control.getAggregation("ambientLight"));rendererManager.renderControl(control.getAggregation("directionalLight"));rendererManager.renderControl(new HTML().setDOMContent(control.getWebGLRenderer().domElement));rendererManager.write("</div>");jQuery.each(control.getObjects(),function(x,object){return objLoader.load(object.getObjFilePath(),function(loadedObject){loadedObject.position.x=object.getObjPositionX();loadedObject.position.z=object.getObjPositionZ();loadedObject.position.y=object.getObjPositionY();control.getScene().add(loadedObject);});});control._renderPerFrame();}}});});